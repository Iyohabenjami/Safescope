<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>IP Report - SafeScope</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #0b1220; color: #e6eef8; font-family: Inter, system-ui; }
    .glass { background: rgba(255,255,255,0.03); padding:18px; border-radius:12px; }
  </style>
</head>
<body class="p-6">
  <div class="max-w-4xl mx-auto">
    <div class="flex justify-between items-start">
      <h1 class="text-2xl font-semibold">IP Report: {{ result.ip }}</h1>
      <div>
        {% set v = result.verdict or 'Unknown' %}
        {% if 'Malicious' in v %}
          <span style="background:rgba(239,68,68,0.12);color:#b91c1c;padding:6px 10px;border-radius:999px">Malicious</span>
        {% elif 'Suspicious' in v %}
          <span style="background:rgba(250,204,21,0.12);color:#b45309;padding:6px 10px;border-radius:999px">Suspicious</span>
        {% elif 'Safe' in v %}
          <span style="background:rgba(34,197,94,0.12);color:#16a34a;padding:6px 10px;border-radius:999px">Safe</span>
        {% else %}
          <span style="background:rgba(107,114,128,0.08);color:#374151;padding:6px 10px;border-radius:999px">Unknown</span>
        {% endif %}
      </div>
    </div>

    <div class="mt-6 glass">
      <h3 class="font-semibold">Summary</h3>
      <p class="text-sm mt-2"><strong>Reverse DNS:</strong> {{ result.rev_dns or result.rev_dns_error }}</p>
      <p class="text-sm"><strong>IP info:</strong> {{ result.ipinfo | tojson }}</p>
    </div>

    <div class="mt-4 flex gap-2">
      <a href="/" class="px-4 py-2 rounded-md border">Back</a>
      <button onclick="openReport()" class="px-4 py-2 rounded-md" style="background:#6c63ff;color:white">Report</button>
    </div>
  </div>

<script>
  function openReport(){
    const body = { type: 'ip', target: '{{ result.ip }}', verdict: '{{ result.verdict or "Unknown" }}', raw: {{ result|tojson }} };
    fetch('/report', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body) }).then(r=>r.json()).then(j=>{
      if(j.status === 'success') alert('Report submitted');
      else alert('Failed to submit');
    }).catch(()=>alert('Network error'));
  }
</script>
</body>
</html>